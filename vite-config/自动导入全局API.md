# 自动导入全局API

自动导入vue3的hooks，借助unplugin-auto-import/vite这个插件。

支持vue, vue-router, vue-i18n, @vueuse/head, @vueuse/core等自动引入。

```js
// 引入前
import { ref, computed } from 'vue'
const count = ref(0)
const doubled = computed(() => count.value * 2)

//引入后
const count = ref(0)
const doubled = computed(() => count.value * 2)


// 引入前
import { useState } from 'react'
export function Counter() {
    const [count, setCount] = useState(0)
    return <div>{ count }</div>
}

//引入后
export function Counter() {
    const [count, setCount] = useState(0)
    return <div>{ count }</div>
}
```

安装

```shell
npm i -D unplugin-auto-import
```

Vite配置

```js
// vite.config.js
import { defineConfig } from 'vite'
import AutoImport from 'unplugin-auto-import/vite'

export default defineConfig({
  plugins: [
    AutoImport({
      imports: ['vue', 'vue-router', 'vue-i18n', '@vueuse/head', '@vueuse/core'],
      // 可以选择auto-import.d.ts生成的位置，使用ts建议设置为'src/auto-import.d.ts'
      // dts: 'src/auto-import.d.ts'
    })
  ]
})
```

原理: 安装的时候会自动生成auto-imports.d文件(默认是在根目录)

```js
// Generated by 'unplugin-auto-import'
// We suggest you to commit this file into source control
declare global {
  const ref: typeof import('vue')['ref']
  const reactive: typeof import('vue')['reactive']
  const computed: typeof import('vue')['computed']
  const createApp: typeof import('vue')['createApp']
  const watch: typeof import('vue')['watch']
  const customRef: typeof import('vue')['customRef']
  const defineAsyncComponent: typeof import('vue')['defineAsyncComponent']
  .
  .
  .
}
export {}
```

可以选择auto-import.d.ts生成的位置，使用ts建议设置为src/auto-import.d.ts

其他插件 vue-router, vue-i18n, @vueuse/head, @vueuse/core等自动引入的自动引入请查看文档

```js
// 插件的所有默认配置
AutoImport({
    // targets to transform
    include: [
        /\.[tj]sx?$/, // .ts, .tsx, .js, .jsx
        /\.vue$/, /\.vue\?vue/, // .vue
        /\.md$/, // .md  
    ],

    // global imports to register
    imports: [
        // presets
        'vue',
        'vue-router',
        // custom
        {
        '@vueuse/core': [
            // named imports
            'useMouse', // import { useMouse } from '@vueuse/core',
            // alias
            ['useFetch', 'useMyFetch'] // import { useFetch as useMyFetch } from '@vueuse/core',
        ],
        'axios': [
            // default imports
            ['default', 'axios'] // import { default as axios } from 'axios',
        ],
        '[package-name]': [
            '[import-names]',
            // alias
            ['[from]', '[alias]']
        ]
        }
    ],

    // custom resolvers
    // 可以在这自定义自己的东西，比如接口api的引入，工具函数等等
    // see https://github.com/antfu/unplugin-auto-import/pull/23/
    resolvers: [
        /* ... */
    ]
})
```


## vue-global-api 解决eslint报错

在页面没有引入的情况下，使用unplugin-auto-import/vite来自动引入hooks，在项目中肯定会报错的，这时候需要在eslintrc.js中的extends引入vue-global-api，这个插件是vue3hooks的,其他自己找找，找不到的话可以手动配置一下globals

安装 vue-global-api

```shell
pnpm i vue-global-api -D
```

```js
// .eslintrc.js
module.exports = {
  extends: [
    'vue-global-api'
  ]
};
```

它还为细粒度控制提供了相同的集合和单个 API 选项。

```js
module.exports = {
  extends: [
    // collections
    'vue-global-api/reactivity',
    'vue-global-api/lifecycle',
    'vue-global-api/component',
    // single apis
    'vue-global-api/ref',
    'vue-global-api/toRef',
  ]
};
```